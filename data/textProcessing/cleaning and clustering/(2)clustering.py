from sklearn.cluster import AgglomerativeClustering
from gensim.scripts.glove2word2vec import glove2word2vec
from gensim.models import KeyedVectors

# Load pre-trained GloVe model
file_glove_wiki = 'glove.6B.300d.txt'
model = KeyedVectors.load_word2vec_format(file_glove_wiki, binary=False, no_header=True)

# These words are from the result of (1)cleaning
#But before use it here some changes were made (removing some words for example)
#description
words = ["methamphetamine","identification","counterfeiting","unidentifiable","paraphernalia","impersonation","eavesdropping","cyberstalking","institutional","demonstration","dissemination","instrument","exploitation","manslaughter","embezzlement","registration","misrepresent","prescription","intimidation","solicitation","interference","transmission","hallucinogen","pornographic","notification","unauthorized","intoxicating","prostitution","videotaping","consumption","compounding","barbiturate","involuntary","endangering","delinquency","pornography","counterfeit","barbiturates","educational","manufacture","amphetamine","abandonment","enforcement","patronizing","obstructing","fornication","information","commercial","electronic","revocation","harassment","contribute","protection","defacement","compelling","collection","mutilation","misconduct","prostitute","controlled","hypodermic","soliciting","automobile","visitation","confidence","ammunition","possession","prohibited","laundering","kidnapping","consensual","conspiracy","monitoring","incendiary","confession","aggravated","distribute","concealed","obscenity","recording","synthetic","violation","interfere","predatory","patronize","influence","insurance","probation","amusement","abduction","restraint","discharge","container","extortion","dangerous","substance","financial","emergency","operation","tampering","passageway","indecency","snatching","servitude","vehicular","vandalism","hazardous","involving","deceptive","advertise","detention","education","equipment","hijacking","residence","explosive","supported","pandering","marijuana","protected","strongarm","telephone","fighting","licensed","compound","invasion","firework","reckless","disclose","recovery","juvenile","disabled","offender","violence","document","official","relation","building","indecent","register","employee","judicial","incident","facility","criminal","business","refusing","location","burglary","operated","identity","delivery","stranger","arsonist","piercing","practice","passport","arrestee","forcible","recorded","computer","cannabis","property","stalking","material","domestic","homicide","obstruct","unlawful","narcotic","altered","violent","elderly","tobacco","citizen","service","forfeit","contact","license","violate","chicago","address","private","vehicle","mislaid","airport","assault","officer","machine","scooter","bribery","premise","cutting","pimping","cocaine","smoking","suspect","forgery","library","exploit","product","neglect","illegal","runaway","receive","picking","peeping","justice","looting","solicit","firearm","process","handgun","closure","offense","summary","conduct","obscene","attempt","battery","serious","deliver","resist","victim","police","deface","ritual","needle","simple","health","heroin","threat","record","bigamy","second","pocket","murder","action","tavern","liquor","report","person","tamper","member","strong","mobile","stolen","retail","parole","bullet","escape","harbor","device","matter","senior","public","animal","intent","change","lessee","unborn","degree","disarm","weapon","annual","aiding","employ","family","higher","credit","injury","school","sexual","bogus","alike","money","abuse","state","arson","equip","black","crime","civil","found","knife","brown","cycle","child","title","armor","check","fraud","plane","plant","theft","entry","print","armed","gram","image","minor","carry","board","rifle","truck","finan","ident","order","sound","first","place","alter","maintenance","motorhome","metal","white","crack","alarm","motor","purse","labor","false","posse","adult","forge","fight","bail","duty","life","card","bike","sale","cont","sell","crim","keep","zone","coin","fire","dist","care","land","foot","lost","city","prop","hand","bomb","mean","inst","home","cash","manu","dang","dice","tool","fist","gram","give","body","call","drug","bond","mark","game","fail","look","ammo","aid","vin","tar","emp","mob","agg","sex","age","etc","pay","att","mbr","inj","non","act","hiv","del","300","gps","mat","tan","air","new","reg","app","way","vio","dev","trp","brn","min","buy","pcp","arm","sub","bus","cut","cab","use","law","gun","500","10","18","30"]

#location
#words = ["transportation","establishment","entertainment","manufacturing","construction","convenience","residential","dealership","university","expressway","department","commercial","watercraft","restaurant","government","waterfront","retirement","barbershop","synagogue","newsstand","riverbank","warehouse","stairwell","mezzanine","lakefront","automatic","abandoned","residence","appliance","apartment","vestibule","delivery","aircraft","elevator","exterior","hospital","sidewalk","cemetary","operated","basement","currency","business","railroad","property","terminal","cleaning","platform","preserve","exchange","athletic","facility","building","driveway","airport","taxicab","specify","grocery","theater","private","stadium","federal","station","nursing","machine","parking","banquet","worship","factory","gangway","highway","bowling","grammar","rooming","vending","library","service","vehicle","medical","trailer","hallway","college","trolley","bridge","teller","retail","animal","subway","beauty","public","dental","ground","credit","stable","secure","tavern","kennel","vacant","barber","wooded","garage","office","system","forest","school","police","liquor","street","repair","saving","center","church","party","store","hotel","house","upper","union","salon","train","drive","river","arena","movie","share","place","right","level","porch","track","sport","lobby","depot","small","front","lower","truck","motel","horse","alley","site","area","lock","park","ride","auto","bank","care","jail","home","drug","boat","yard","back","food","pool","pawn","coin","ymca","shop","wash","uber","hall","lake","prop","play","stop","loan","farm","fire","land","room","lyft","club","lot","way","cta","car","bar","gas","bus","atm","ch"]

# Get word vectors
word_vectors = [model[word] for word in words]

# Perform hierarchical clustering
clustering = AgglomerativeClustering(n_clusters=75, distance_threshold=None).fit(word_vectors) #40 for location - 75 for description

# Assign cluster labels to words
word_clusters = {}
for word, cluster_label in zip(words, clustering.labels_):
    word_clusters.setdefault(cluster_label, []).append(word)

#the clusters are used in (3)textProcessing
# Print the clusters
for cluster, words in word_clusters.items():
    print(f"Words: {words}")
